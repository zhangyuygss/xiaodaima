clear;

% osborne
x0 = [1.3, 0.65, 0.65, 0.7, 0.6, 3.0, 5.0, 7.0, 2.0, 4.5, 5.5]';
[xs1, vals, k] = gauss_newton('osborneF', 'osborneG', 'osborneR', 'osborneJ', x0);
[xs2, vals, k] = dogleg('osborneR', 'osborneJ', x0);
[xs3, vals, k] = LMF('osborneR', 'osborneJ', x0);
[xs4, vals, k] = conjugate_gradient('osborneF', 'osborneG', x0, 'FR');

t = [0:0.1:6.4]';
y = [1.366, 1.191, 1.112, 1.013, 0.991, 0.885, 0.831, 0.847,...
	  0.786, 0.725, 0.746, 0.679, 0.608, 0.655, 0.616, 0.606,...
	  0.602, 0.626, 0.651, 0.724, 0.649, 0.649, 0.694, 0.644,...
	  0.624, 0.661, 0.612, 0.558, 0.533, 0.495, 0.500, 0.423,...
	  0.395, 0.375, 0.372, 0.391, 0.396, 0.405, 0.428, 0.429,...
	  0.523, 0.562, 0.607, 0.653, 0.672, 0.708, 0.633, 0.668,...
	  0.645, 0.632, 0.591, 0.559, 0.597, 0.625, 0.739, 0.719,...
	  0.729, 0.720, 0.636, 0.581, 0.428, 0.292, 0.162, 0.098, 0.054]';
x = xs1(end, :);
f = x(1)*exp(-x(5)*t) + x(2)*exp(-x(6)*((t-x(9)).^2)) + ...
	x(3)*exp(-x(7)*((t-x(10)).^2)) + x(4)*exp(-x(8)*((t-x(11)).^2));
subplot(2,2,1);  plot(t,y,'.', t,f); title('GN')
x = xs2(end, :);
f = x(1)*exp(-x(5)*t) + x(2)*exp(-x(6)*((t-x(9)).^2)) + ...
	x(3)*exp(-x(7)*((t-x(10)).^2)) + x(4)*exp(-x(8)*((t-x(11)).^2));
subplot(2,2,2);  plot(t,y,'.', t,f);  title('LMF')
x = xs3(end, :);
f = x(1)*exp(-x(5)*t) + x(2)*exp(-x(6)*((t-x(9)).^2)) + ...
	x(3)*exp(-x(7)*((t-x(10)).^2)) + x(4)*exp(-x(8)*((t-x(11)).^2));
subplot(2,2,3);  plot(t,y,'.', t,f);  title('Dogleg')
x = xs4(end, :);
f = x(1)*exp(-x(5)*t) + x(2)*exp(-x(6)*((t-x(9)).^2)) + ...
	x(3)*exp(-x(7)*((t-x(10)).^2)) + x(4)*exp(-x(8)*((t-x(11)).^2));
subplot(2,2,4);  plot(t,y,'.', t,f);  title('Conjugate gradient')






